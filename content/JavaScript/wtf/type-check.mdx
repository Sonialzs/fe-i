---
title: 'ç±»å‹åˆ¤æ–­'
slug: 'type-check'
date: '2020-11-23'
category: 'JavaScript'
index: 2
authors:
    - cuvii
authorsUrl:
    - https://fei.kodin.fun
draft: false
---

### æ€»ç»“

`typeof` å¯ä»¥åˆ¤æ–­**å€¼ç±»å‹**å’Œ **object**ä»¥åŠ**function**ã€‚ä½†æ˜¯å­˜åœ¨` typeof null` è¿”å›`object`çš„ bugã€‚

`instanceof` æ˜¯æ ¹æ®åŸå‹é“¾æ¥åˆ¤æ–­ï¼Œåªèƒ½åˆ¤æ–­å¯¹è±¡ã€‚

`constructor` æ˜¯æ ¹æ®æ„é€ å‡½æ•°è¿›è¡Œåˆ¤æ–­ã€‚

`Object.prototype.toString.call()`å¯ä»¥åˆ¤æ–­ä»»ä½•ç±»å‹ã€‚

## typeof

```js:typeof run
console.log(typeof 123);
console.log(typeof 'cuvii');
console.log(typeof true);
console.log(typeof null); // "object"
console.log(typeof undefined);
console.log(typeof {}); // "object"
console.log(typeof []); // "object"
function fn() {}
console.log(typeof fn);
```

`typeof []`å¹¶æ²¡æœ‰è¿”å›`"array"`ï¼Œè€Œæ˜¯`object`ã€‚å› ä¸ºåœ¨ JavaScript ä¸­ï¼Œæ•°ç»„ Arrayã€å‡½æ•° Function ç­‰éƒ½æ˜¯æ´¾ç”Ÿè‡ª`object`çš„ï¼ˆè¿˜æœ‰ Dateã€Errorã€Map ç­‰ï¼Œè¯¦è§[å¼•ç”¨ç±»å‹]()ï¼‰ï¼Œè€Œ typeof å¯¹äºå¼•ç”¨ç±»å‹åªèƒ½åˆ¤æ–­ object å’Œ functionï¼Œå¯¹äºæ•°ç»„ã€Dateã€Map ç­‰éƒ½è¿”å›`object`ã€‚

è¿™æ˜¯ `typeof` çš„å±€é™æ€§ï¼Œæ— æ³•å‡†ç¡®åˆ¤æ–­å¼•ç”¨ç±»å‹ã€‚

ç¬¬å››è¡Œä»£ç ä¸­ï¼Œ`typeof null`ä¹Ÿè¿”å›äº†`object`ã€‚`null` æ˜¯å€¼ç±»å‹ï¼Œä¸ºä»€ä¹ˆè¢«åˆ¤æ–­æˆäº†`object`ï¼Ÿ

è¿™æ˜¯ JavaScript çš„ bugã€‚

åœ¨ JavaScript ç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼Œå˜é‡ä»¥**ç±»å‹æ ‡ç­¾**(typetag)å’Œ**å€¼**æ¥è¡¨ç¤ºã€‚`object`çš„ç±»å‹æ ‡ç­¾æ˜¯ 0ï¼Œè€Œ` null` æ˜¯ç”¨æ¥è¡¨ç¤ºç©ºæŒ‡é’ˆçš„ï¼Œå¤§å¤šæ•°å¹³å°ä¸‹å€¼ä¸º`0x00`ï¼Œä¹Ÿè¢«å½“ä½œ 0 å¤„ç†ã€‚

## instanceof

`instanceof` ç”¨æ¥åˆ¤æ–­å¼•ç”¨ç±»å‹çš„ç±»å‹ï¼Œå‡†ç¡®æ¥è¯´æ˜¯ï¼Œåˆ¤æ–­å³ä¾§ç±»çš„æ„é€ å‡½æ•°æ˜¯å¦å‡ºç°åœ¨å·¦ä¾§å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚ä¾‹å¦‚ï¼š

```js:instanceof run
const o = {};

console.log(o instanceof Object)
```

```js:instanceof1 run
console.log(123 instanceof Number);
console.log(`cuvii` instanceof String);
console.log(true instanceof Boolean);
console.log(null instanceof Object);
```

ä»è¿™æ®µä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºå€¼ç±»å‹çš„åˆ¤æ–­éƒ½è¿”å› `false`ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ`instanceof `ä¸èƒ½åˆ¤æ–­å€¼ç±»å‹ï¼Œåªèƒ½åˆ¤æ–­å¼•ç”¨ç±»å‹çš„ç±»å‹ã€‚

```js:instanceof2 run

function fn(){}
console.log(fn instanceof Function)
console.log(fn instanceof Object)
```

å› ä¸º `Function` ç±»ç»§æ‰¿è‡ª `Object`ï¼Œæ‰€ä»¥ç»“æœéƒ½ä¸º `true`ã€‚

## constructor

`constructor`æ˜¯ç›´æ¥ä½¿ç”¨æ„é€ å‡½æ•°æ¥è¿›è¡Œåˆ¤æ–­ï¼Œä¸è€ƒè™‘åŸå‹é“¾ã€‚

```js:constructor run
const number = 1;
const boolean = true;
const string = 'cuvii'
const func = function(){}
const object = {}
class Person{}
const p1 = new Person()

console.log(number.constructor === Number) // true
console.log(boolean.constructor === Boolean) //true
console.log(string.constructor === String) //true
console.log(func.constructor === Function) //true
console.log(object.constructor === Object) // true
console.log(p1.constructor === Person) // true
// â—å¹¶ä¸è€ƒè™‘åŸå‹é“¾
console.log(func.constructor === Object) //false

```

é€šè¿‡ constructor èƒ½å‡†ç¡®åˆ¤æ–­å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹å…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªéšæ‚£åœ¨äºï¼Œconstructor æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼ä»¥ä¸Šä»£ç ä¸­ï¼Œå¯¹ p1 ç¨ä½œä¿®æ”¹ï¼š

```js run
class Person {}
const p1 = new Person();
p1.constructor = Object;
console.log(p1.constructor === Person); // false
```

## Object.prototype.toString.call()

`Object.prototype.toString.call()`æ˜¯æ›´å®Œå–„ä¸€ç‚¹çš„ç±»å‹åˆ¤æ–­æ–¹æ³•ï¼Œå¯ä»¥åˆ¤æ–­ä»»ä½•ç±»å‹ã€‚
`Object.prototype.toString` æ–¹æ³•ä¼šè¾“å‡º`[object [[Class]]]`è¿™æ ·çš„å€¼ï¼Œå…¶ä¸­`[[Class]]`å°±æ˜¯å¯¹è±¡çš„ `class` å±æ€§ã€‚

> æ¯ä¸ª JavaScript å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§`[[Class]]`ã€‚

é€šè¿‡è¿™ä¸ªæ–¹æ³•ï¼Œå¯ä»¥å‡†ç¡®è·å–åˆ°å¯¹è±¡çš„ç±»å‹ã€‚

```js:Object.prototype.toString.call()
var num = 123;
var str = 'abcdef';
var bool = true;
var arr = [1, 2, 3, 4];
var json = { name: 'jsliang', age: 25 };
var func = function () { console.log('this is function'); }
var und = undefined;
var nul = null;
var date = new Date();
var reg = /^[a-zA-Z]{5,20}$/;
var error = new Error();

console.log(
    Object.prototype.toString.call(num), // [object Number]
    Object.prototype.toString.call(str), // [object String]
    Object.prototype.toString.call(bool), // [object Boolean]
    Object.prototype.toString.call(arr), // [object Array]
    Object.prototype.toString.call(json), // [object Object]
    Object.prototype.toString.call(func), // [object Function]
    Object.prototype.toString.call(und), // [object Undefined]
    Object.prototype.toString.call(nul), // [object Null]
    Object.prototype.toString.call(date), // [object Date]
    Object.prototype.toString.call(reg), // [object RegExp]
    Object.prototype.toString.call(error), // [object Error]
  );

```

ä»¥ä¸Šä»£ç ç‰‡æ®µå–è‡ª[jsliang æ±‚èŒç³»åˆ— - 04 - JavaScript å˜é‡](https://juejin.cn/post/6891457912171200525#heading-14)ã€‚

### å‚è€ƒ

-   [The history of â€œtypeof nullâ€](https://2ality.com/2013/10/typeof-null.html)
-   ğŸ”¥[Fixing the JavaScript typeof operator](https://javascriptweblog.wordpress.com/2011/08/08/fixing-the-javascript-typeof-operator/)
-   [Class checking: "instanceof"](https://javascript.info/instanceof)
