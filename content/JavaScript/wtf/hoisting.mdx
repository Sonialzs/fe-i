---
title: 'å˜é‡æå‡'
slug: 'hoisting'
date: '2020-11-24'
category: 'JavaScript'
index: 5
authors:
    - cuvii
authorsUrl:
    - https://fei.kodin.fun
draft: false
---

> æ‰€è°“çš„å˜é‡æå‡ï¼Œæ˜¯æŒ‡åœ¨ JavaScript ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼ŒJavaScript å¼•æ“ŽæŠŠå˜é‡çš„å£°æ˜Žéƒ¨åˆ†å’Œå‡½æ•°çš„å£°æ˜Žéƒ¨åˆ†æå‡åˆ°ä»£ç å¼€å¤´çš„â€œè¡Œä¸ºâ€ã€‚å˜é‡è¢«æå‡åŽï¼Œä¼šç»™å˜é‡è®¾ç½®é»˜è®¤å€¼ï¼Œè¿™ä¸ªé»˜è®¤å€¼å°±æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„ undefinedã€‚
>
> â€”â€”ã€Šæµè§ˆå™¨å·¥ä½œåŽŸç†ä¸Žå®žè·µã€‹ æŽå…µ

## var å’Œå‡½æ•°å£°æ˜Ž

åœ¨ JavaScript ä¸­ï¼Œ`var` å£°æ˜Žä¼šå­˜åœ¨å˜é‡æå‡çš„æƒ…å†µï¼Œå¯ä»¥åœ¨å˜é‡å£°æ˜Žä¹‹å‰è®¿é—®å˜é‡ã€‚

```js
console.log(name); // undefined

var name = 'cuvii';

console.log(name); // 'cuvii'
```

å‘ç”Ÿå˜é‡æå‡ä¹‹åŽç±»ä¼¼ä¸‹é¢è¿™æ®µä»£ç ã€‚å¯ä»¥çœ‹åˆ°åªæœ‰å£°æ˜Žéƒ¨åˆ†`var name`æå‡åˆ°äº†æœ€é¡¶éƒ¨ï¼Œèµ‹å€¼è¯­å¥è¿˜æ˜¯ä¿æŒä¸åŠ¨ã€‚

```js
var name;

console.log(name); // undefined

name = 'cuvii';

console.log(name); // 'cuvii'
```

å¯¹äºŽå‡½æ•°å£°æ˜Žï¼Œä¹Ÿä¼šå‘ç”Ÿæå‡çš„æƒ…å†µã€‚

```js run
// è°ƒç”¨åœ¨å®šä¹‰å‰
sayHi();

function sayHi() {
	console.log('hi');
}
```

è€Œå‡½æ•°è¡¨è¾¾å¼åˆ™ä¸ä¼šå‘ç”Ÿæå‡ï¼Œå¿…é¡»å…ˆå£°æ˜Žï¼ŒåŽä½¿ç”¨ã€‚

```js run
console.log(add); // undefined
var add = function add() {
	console.log('add');
};
```

ä¸Šé¢è¿™ä¸ªä»£ç ç‰‡æ®µä¸­ï¼Œ`var add`å‘ç”Ÿäº†å˜é‡æå‡ï¼Œé»˜è®¤å€¼æ˜¯ undefinedã€‚å¦å¤–ï¼Œ`var add = function add(){}`ä¸­ï¼Œç­‰å·å³ä¾§å±žäºŽå‡½æ•°è¡¨è¾¾å¼ï¼Œä¸æ˜¯å‡½æ•°å£°æ˜Žï¼Œæ‰€ä»¥ä¸ä¼šå‘ç”Ÿæå‡ã€‚

> å‡½æ•°å£°æ˜Žå’Œå‡½æ•°è¡¨è¾¾å¼
>
> ä¸€æ®µ**è¯­å¥**ä»¥ `function` å¼€å¤´å°±æ˜¯å‡½æ•°å£°æ˜Žï¼Œå¦åˆ™æ˜¯å‡½æ•°è¡¨è¾¾å¼ï¼Œä¾‹å¦‚ä¸Šé¢ä»£ç ç‰‡æ®µä¸­ï¼Œè¿™æ®µè¯­å¥æ˜¯ä»¥`var add`å¼€å¤´çš„ï¼Œæ‰€ä»¥æ˜¯å‡½æ•°è¡¨è¾¾å¼ã€‚

å®žé™…ä¸Šï¼ŒJavaScript æ˜¯é€šè¿‡**æ‰§è¡Œä¸Šä¸‹æ–‡**æ¥å®žçŽ°æå‡çš„ã€‚åœ¨æ‰§è¡Œä¸€æ®µä»£ç å‰ï¼ŒJS ä¼šå…ˆç¼–è¯‘è¿™æ®µä»£ç ï¼Œæ‰¾åˆ°ä»£ç ä¸­çš„ var å’Œå‡½æ•°å£°æ˜Žï¼Œå­˜å‚¨åœ¨æ‰§è¡Œä¸Šä¸‹æ–‡çš„**å˜é‡çŽ¯å¢ƒ**ä¸­ã€‚

åœ¨è¿™ä¸ªé˜¶æ®µï¼Œå¦‚æžœæœ‰åŒåçš„ var æˆ–å‡½æ•°å£°æ˜Žï¼ˆå…¶å®žä¸ç”¨è€ƒè™‘åŒå var çš„æƒ…å†µï¼‰ï¼ŒåŽè¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä¼šè¦†ç›–ä¹‹å‰çš„ï¼Œæ­¤æ—¶æ‰€æœ‰ var çš„å€¼éƒ½æ˜¯`undefined`ã€‚

ç¼–è¯‘å®ŒæˆåŽï¼Œä»£ç è¿›å…¥æŒ‡å‘é˜¶æ®µï¼Œå°±ä¼šä»Žå˜é‡çŽ¯å¢ƒä¸­æŸ¥æ‰¾ç›¸åº”çš„å˜é‡æˆ–å‡½æ•°ã€‚

## æš‚æ—¶æ€§æ­»åŒº

å½“ä½¿ç”¨ let å’Œ const å…³é”®å­—å£°æ˜Žå˜é‡æ—¶ï¼Œä¸ä¼šå‘ç”Ÿæå‡ï¼Œå¿…é¡»åœ¨å£°æ˜Žä¹‹åŽæ‰èƒ½ä½¿ç”¨ã€‚å¦‚æžœåœ¨å£°æ˜Žå˜é‡ä¹‹å‰ä½¿ç”¨ï¼Œä¼šäº§ç”Ÿæš‚æ—¶æ€§æ­»åŒºï¼ˆTDZï¼‰ã€‚

```js run
var name = 'cuvii';
{
	console.log(name);
	let name = 'lilith';
}
```

ä¸Šé¢è¿™æ®µä»£ç ä¼šè¾“å‡ºä»€ä¹ˆï¼Ÿ

çœ‹èµ·æ¥å¥½åƒæ˜¯è¾“å‡º`"cuvii"`ï¼Œå¾ˆé—æ†¾ï¼Œå¹¶ä¸æ˜¯ã€‚

è¿™é‡Œæ¶‰åŠåˆ°æ‰§è¡Œä¸Šä¸‹æ–‡å’Œä½œç”¨åŸŸé“¾çš„çŸ¥è¯†ã€‚

æ‰§è¡Œä»£ç æ—¶ï¼Œä¼šå…ˆåˆ°å½“å‰ä½œç”¨åŸŸä¸­æŸ¥æ‰¾ï¼Œç„¶åŽå†åŽ»å¤–å±‚ä½œç”¨åŸŸä¸­æŸ¥æ‰¾ï¼Œç›´åˆ°å…¨å±€ä½œç”¨åŸŸä¸ºæ­¢ã€‚

ä¸Šé¢è¿™æ®µä»£ç ä¸­ï¼Œ`console.log(name)`ä¼šå…ˆåœ¨å½“å‰ä½œç”¨åŸŸä¸­æŸ¥æ‰¾ name å˜é‡ï¼Œç”±äºŽ name å˜é‡æ˜¯ä½¿ç”¨ let å£°æ˜Žçš„ï¼Œæ‰€ä»¥äº§ç”Ÿäº† TDZã€‚

ä¼¼ä¹Žæ˜¯æœ‰ç‚¹è¯´ä¸é€šï¼Œlet å’Œ const ä¸æ˜¯ä¸ä¼šå‘ç”Ÿæå‡å—ï¼Ÿé‚£ JS æ€Žä¹ˆçŸ¥é“å½“å‰ä½œç”¨åŸŸå­˜åœ¨é€šè¿‡ let å£°æ˜Žçš„ name å˜é‡å‘¢ï¼Ÿ

å®žé™…ä¸Š let å’Œ const ä¸ä¼šå‘ç”Ÿæå‡çš„è¯´æ³•æ˜¯é”™è¯¯çš„ï¼Œæ ¹æ® [ECMA è§„èŒƒ](https://www.ecma-international.org/ecma-262/9.0/index.html#sec-let-and-const-declarations)ï¼š

> The(let/const) **variables are created when their containing Lexical Environment is instantiated** but may not be accessed in any way until the variableâ€™s LexicalBinding is evaluated.

-   `var`çš„åˆ›å»ºå’Œåˆå§‹åŒ–è¢«æå‡ï¼Œèµ‹å€¼ä¸ä¼šè¢«æå‡ã€‚
-   `let`çš„åˆ›å»ºè¢«æå‡ï¼Œåˆå§‹åŒ–å’Œèµ‹å€¼ä¸ä¼šè¢«æå‡ã€‚
-   `function`çš„åˆ›å»ºã€åˆå§‹åŒ–å’Œèµ‹å€¼å‡ä¼šè¢«æå‡ã€‚

## class

class å’Œ function ç›¸åŒï¼Œä¹Ÿåˆ†ä¸ºç±»å£°æ˜Žå’Œç±»è¡¨è¾¾å¼ã€‚

ç±»å£°æ˜Žå’Œå‡½æ•°å£°æ˜Žä¸åŒï¼Œç±»å£°æ˜Žçš„åˆ›å»ºä¼šè¢«æå‡ï¼Œä½†æ˜¯åˆå§‹åŒ–ä¸ä¼šã€‚

## å‚è€ƒèµ„æ–™

> -   [å˜é‡æå‡ â€”â€” MDN](https://developer.mozilla.org/zh-CN/docs/Glossary/Hoisting)
> -   [Understanding Hoisting in JavaScript](https://www.digitalocean.com/community/tutorials/understanding-hoisting-in-javascript)
> -   ðŸ”¥[å˜é‡æå‡ï¼šJavaScript ä»£ç æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„å—ï¼Ÿ](https://time.geekbang.org/column/article/119046)
> -   [Are variables declared with let or const hoisted?](https://stackoverflow.com/questions/31219420/are-variables-declared-with-let-or-const-hoisted)
